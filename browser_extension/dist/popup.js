import{c as i,u as P,r as h,j as e,a as D}from"./assets/styles-Ce1DRJl1.js";/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],q=i("circle-check",E);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],V=i("circle-play",F);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],O=i("file-text",W);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],G=i("globe",R);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"m14.479 19.374-.971.939a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5a5.2 5.2 0 0 1-.219 1.49",key:"wg5jx"}],["path",{d:"M15 15h6",key:"1u4692"}],["path",{d:"M18 12v6",key:"1houu1"}]],K=i("heart-plus",J);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],X=i("image",Q);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Z=i("loader-circle",Y);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],se=i("settings",ee);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M6.376 18.91a6 6 0 0 1 11.249.003",key:"hnjrf2"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}]],T=i("shield-user",te);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ie=i("triangle-alert",ae);function ne(){var j,N,v,_,k;const{isConnected:r,connect:U,analyzeDom:B,sendMessage:f}=P(),[s,b]=h.useState(null),[o,p]=h.useState(!1);h.useEffect(()=>{U()},[]);const S=async()=>{const t=await f({type:"heartbeat"});console.log("Heartbeat result → ",t)},A=async()=>{p(!0);try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(t!=null&&t.url))return;const a=await B(t.id);if(console.log("DOM verification result →",a),a!=null&&a.result)b(a.result);else if((a==null?void 0:a.success)===!1){const l=await f({type:"url_analysis",url:t.url});b(l)}}catch(t){console.error("Failed to verify URL:",t)}finally{p(!1)}},n=(s==null?void 0:s.page_classification)!=="bad",d=s?(s.page_confidence*100).toFixed(1):null,x=typeof((j=s==null?void 0:s.domain_analysis)==null?void 0:j.risk_score)=="number"?s.domain_analysis.risk_score:null,u=typeof((N=s==null?void 0:s.domain_analysis)==null?void 0:N.risk_score)=="number"?((1-s.domain_analysis.risk_score)*100).toFixed(1):null,m=((v=s==null?void 0:s.image_analysis)==null?void 0:v.bad_image_elements)||[],g=((_=s==null?void 0:s.text_analysis)==null?void 0:_.bad_text_elements)||[],c=x===null?{iconBg:"bg-slate-100",iconText:"text-slate-700",badgeBg:"bg-slate-100",badgeText:"text-slate-700"}:x>=.9?{iconBg:"bg-rose-100",iconText:"text-rose-700",badgeBg:"bg-rose-100",badgeText:"text-rose-700"}:x>=.5?{iconBg:"bg-amber-100",iconText:"text-amber-700",badgeBg:"bg-amber-100",badgeText:"text-amber-700"}:{iconBg:"bg-emerald-100",iconText:"text-emerald-700",badgeBg:"bg-emerald-100",badgeText:"text-emerald-700"},y=async t=>{var w,z,$,M,C;if(!s)return;const a=t==="images"?m:g;if(!a.length||typeof chrome>"u"||!((w=chrome.storage)!=null&&w.local)||!((z=chrome.tabs)!=null&&z.create)||!(($=chrome.runtime)!=null&&$.getURL))return;const l=`finding_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,L={section:t,createdAt:Date.now(),requestedUrl:s.requested_url||"",domain:((M=s==null?void 0:s.domain_analysis)==null?void 0:M.domain)||"",category:((C=s==null?void 0:s.domain_analysis)==null?void 0:C.category)||"unknown",items:a};await chrome.storage.local.set({[l]:L});const H=chrome.runtime.getURL(`blocked.html?view=details&section=${encodeURIComponent(t)}&id=${encodeURIComponent(l)}`);await chrome.tabs.create({url:H})},I=async()=>{var a,l;if(typeof chrome>"u"||!((a=chrome.runtime)!=null&&a.getURL)||!((l=chrome.tabs)!=null&&l.create))return;const t=chrome.runtime.getURL("settings.html");await chrome.tabs.create({url:t})};return e.jsxs("div",{className:"h-[600px] overflow-hidden bg-gradient-to-b from-slate-50 to-slate-100 flex flex-col",children:[e.jsx("header",{className:"border-b border-slate-200 bg-white px-5 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"size-9 rounded-xl bg-indigo-600 flex items-center justify-center shadow-sm",children:e.jsx(T,{className:"size-4 text-white",strokeWidth:2.5})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-base font-semibold tracking-tight text-slate-900",children:"SafeNest"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:"Child safety monitor"})]})]}),e.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${r?"text-emerald-700":"text-rose-700"}`,children:[e.jsx("span",{className:`size-1.5 rounded-full ${r?"bg-emerald-500":"bg-rose-500"}`}),r?"Connected":"Offline"]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar px-5 py-4",children:[s&&e.jsxs("div",{children:[e.jsx("div",{className:`rounded-xl px-3.5 py-3 border ${n?"bg-emerald-50 border-emerald-200/70":"bg-rose-50 border-rose-200/70"}`,children:e.jsxs("div",{className:"flex items-start gap-2.5",children:[e.jsx("div",{className:`mt-0.5 size-5 shrink-0 ${n?"text-emerald-600":"text-rose-600"}`,children:n?e.jsx(q,{className:"size-5"}):e.jsx(ie,{className:"size-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-semibold tracking-tight ${n?"text-emerald-900":"text-rose-900"}`,children:n?"Page looks safe":"Unsafe content detected"}),e.jsxs("p",{className:`mt-1 text-xs font-medium ${n?"text-emerald-700":"text-rose-700"}`,children:[(k=s.page_classification)==null?void 0:k.toUpperCase()," · ",d,"% confidence"]})]})]})}),e.jsxs("div",{className:"my-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Confidence"}),e.jsxs("span",{className:"text-xs font-semibold text-slate-700",children:[d,"%"]})]}),e.jsx("div",{className:"h-2 rounded-full bg-slate-100 overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${n?"bg-emerald-500":"bg-rose-500"}`,style:{width:`${d}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2.5",children:[s.domain_analysis&&e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50/70 px-3.5 py-3 flex items-start gap-3",children:[e.jsx("div",{className:`size-8 rounded-lg ${c.iconBg} ${c.iconText} flex items-center justify-center shrink-0 mt-0.5`,children:e.jsx(G,{className:"size-[14px]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-900",children:"Domain safety"}),e.jsx("span",{className:`inline-flex rounded-md ${c.badgeBg} ${c.badgeText} px-1.5 py-0.5 text-[11px] font-semibold`,children:u?`${u}%`:"N/A"})]}),e.jsxs("p",{className:"mt-1 text-[11px] leading-4 text-slate-500 line-clamp-2",children:[s.domain_analysis.domain||"unknown domain",s.domain_analysis.category?` • ${s.domain_analysis.category}`:""]})]})]}),s.image_analysis&&e.jsxs("button",{type:"button",onClick:()=>y("images"),disabled:m.length===0,className:`w-full text-left rounded-xl border border-slate-200 bg-slate-50/70 px-3.5 py-3 flex items-center gap-3 transition-colors ${m.length>0?"cursor-pointer hover:bg-slate-100/80":"cursor-default"}`,children:[e.jsx("div",{className:"size-8 rounded-lg bg-violet-100 text-violet-700 flex items-center justify-center shrink-0",children:e.jsx(X,{className:"size-[14px]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-900",children:"Image scan"}),e.jsxs("p",{className:"text-[11px] text-slate-500",children:[s.image_analysis.images_analyzed," analyzed"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] shrink-0",children:[e.jsx("span",{className:"inline-flex rounded-md bg-rose-100 text-rose-700 px-1.5 py-0.5 font-semibold",children:s.image_analysis.bad_images}),e.jsx("span",{className:"inline-flex rounded-md bg-emerald-100 text-emerald-700 px-1.5 py-0.5 font-semibold",children:s.image_analysis.good_images})]})]}),s.text_analysis&&e.jsxs("button",{type:"button",onClick:()=>y("text"),disabled:g.length===0,className:`w-full text-left rounded-xl border border-slate-200 bg-slate-50/70 px-3.5 py-3 flex items-start gap-3 transition-colors ${g.length>0?"cursor-pointer hover:bg-slate-100/80":"cursor-default"}`,children:[e.jsx("div",{className:"size-8 rounded-lg bg-sky-100 text-sky-700 flex items-center justify-center shrink-0 mt-0.5",children:e.jsx(O,{className:"size-[14px]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-900",children:"Text analysis"}),e.jsx("span",{className:`inline-flex rounded-md px-1.5 py-0.5 text-[11px] font-semibold ${s.text_analysis.classification==="bad"?"bg-rose-100 text-rose-700":"bg-emerald-100 text-emerald-700"}`,children:s.text_analysis.classification})]}),s.text_analysis.reason&&e.jsx("p",{className:"mt-1 text-[11px] leading-4 text-slate-500 line-clamp-2",children:s.text_analysis.reason})]})]})]})]}),!s&&!o&&e.jsxs("div",{className:"h-full min-h-[220px] flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"size-12 rounded-full bg-white border border-slate-200 shadow-sm flex items-center justify-center mb-3",children:e.jsx(T,{className:"size-7 text-slate-500",strokeWidth:1.8})}),e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Ready to scan this page"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Run verification to see a full safety report."})]}),o&&!s&&e.jsxs("div",{className:"h-full min-h-[220px] flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"size-10 mb-3",children:e.jsx(Z,{className:"size-10 animate-spin text-indigo-600"})}),e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Analyzing page…"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Checking text and media content"})]})]}),e.jsxs("div",{className:"border-t border-slate-200/80 bg-white/90 backdrop-blur px-5 pt-5 pb-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:A,disabled:o,className:"inline-flex min-w-[230px] items-center justify-center rounded-2xl bg-indigo-600 px-10 py-2 text-sm font-semibold tracking-tight text-white shadow-[0_10px_20px_rgba(79,70,229,0.28)] hover:bg-indigo-500 transition-all focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:bg-indigo-400 disabled:cursor-not-allowed",children:o?"Scanning…":e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(V,{className:"size-4 mr-1"})," Run Verification"]})})}),e.jsxs("div",{className:"mt-5 flex justify-center",children:[e.jsxs("button",{onClick:S,disabled:o,className:"inline-flex items-center rounded-lg px-3 py-2 text-xs font-medium text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(K,{className:"size-4 mr-1"}),"Send Heartbeat"]}),e.jsxs("button",{onClick:I,disabled:o,className:"inline-flex items-center rounded-lg px-3 py-2 text-xs font-medium text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(se,{className:"size-4 mr-1"}),"Settings"]})]})]})]})}const le=document.getElementById("root"),oe=D(le);oe.render(e.jsx(ne,{}));
